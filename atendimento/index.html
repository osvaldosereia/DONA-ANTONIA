<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cesta Econ√¥mica | Dona Ant√¥nia Alimentos</title>
    <meta name="theme-color" content="#008069">
    <meta name="description" content="Cestas B√°sicas em Cuiab√° e V√°rzea Grande. A melhor qualidade e pre√ßo justo. Pague somente na entrega.">
    <meta name="robots" content="index, follow">

    <!-- SEO LOCAL & SCHEMA MARKUP (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "Dona Ant√¥nia Alimentos",
      "image": "https://donaantonia.com.br/img/logo.png",
      "telephone": "+5565998150975",
      "url": "https://www.donaantonia.com.br",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Cuiab√°",
        "addressRegion": "MT",
        "addressCountry": "BR"
      },
      "priceRange": "$$",
      "openingHoursSpecification": {
        "@type": "OpeningHoursSpecification",
        "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
        "opens": "08:00",
        "closes": "18:00"
      },
      "sameAs": [
        "https://instagram.com/cestas.dona.antonia.cuiaba.vg",
        "https://facebook.com/donaantonia"
      ]
    }
    </script>

    <!-- OTIMIZA√á√ÉO DE PERFORMANCE -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- META PIXEL (PLACEHOLDER - INSIRA SEU ID) -->
    <script>
        // !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
        // fbq('init', 'SEU_ID_PIXEL_AQUI');
        // fbq('track', 'PageView');
    </script>

    <!-- SEGURAN√áA M√ÅXIMA (HEADERS & META) -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https: data:;">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="referrer" content="strict-origin-when-cross-origin">

    <!-- === PROTOCOLO SENTINELA: SEGURAN√áA JS === -->
    <script>
        (function(_0x1e2f){
            // CONFIGURA√á√ÉO DE DOM√çNIOS PERMITIDOS (Whitelist)
            const _0x4d2a = ['donaantonia.com.br', 'www.donaantonia.com.br', '127.0.0.1', 'localhost'];
            
            // 1. DOMAIN LOCK (Trava de Dom√≠nio)
            const _0xcheck = window.location.hostname;
            if (!_0x4d2a.includes(_0xcheck)) {
                // Se detectar clone: Limpa o HTML para o usu√°rio n√£o ver nada e redireciona
                document.documentElement.innerHTML = 'Carregando seguran√ßa...';
                window.location.replace("https://wa.me/5565998150975?text=ALERTA:%20Acessei%20um%20site%20clonado%20que%20estava%20tentando%20se%20passar%20por%20voc√™s!");
                throw new Error("Security Violation: Unauthorized Host");
            }

            // 2. ANTI-DEBUGGER LOOP (Atrapalha a inspe√ß√£o)
            setInterval(function(){
                const _0xdb = new Date();
                (function(){}).constructor("debugger")();
            }, 4000);

            // 3. BLOQUEIO DE A√á√ïES DE C√ìPIA
            document.addEventListener('contextmenu', event => event.preventDefault());
            document.addEventListener('dragstart', event => event.preventDefault());
            
            document.addEventListener('keydown', function(e) {
                if (e.keyCode == 123) { return false; } // F12
                if (e.ctrlKey && e.shiftKey && e.keyCode == 73) { return false; } // Ctrl+Shift+I
                if (e.ctrlKey && e.shiftKey && e.keyCode == 74) { return false; } // Ctrl+Shift+J
                if (e.ctrlKey && e.keyCode == 85) { return false; } // Ctrl+U
                if (e.ctrlKey && e.keyCode == 83) { return false; } // Ctrl+S (Salvar)
            });

            // 4. LIMPEZA DO CONSOLE
            if(window.console || window.console.firebug) {
                console.clear();
            }
        })();
    </script>

    <style>
        /* CSS OBFUSCADO PARA LEITURA HUMANA DIFICULTADA */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #E5DDD5; user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; }
        .wa-header { background-color: #008069; }
        .wa-bg { 
            background-color: #E5DDD5;
            background-image: url("data:image/svg+xml,%3Csvg width='320' height='180' viewBox='0 0 320 180' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239CAFA3' fill-opacity='0.20' fill-rule='evenodd'%3E%3Ctext x='20' y='70' font-family='Arial, sans-serif' font-size='24' font-weight='bold' transform='rotate(-8 20 70)'%3Ewww.donaantonia.com.br%3C/text%3E%3Ctext x='80' y='150' font-family='Arial, sans-serif' font-size='24' font-weight='bold' transform='rotate(-8 80 150)'%3E65 99815-0975%3C/text%3E%3C/g%3E%3C/svg%3E");
            background-repeat: repeat;
        }
        .msg-in { background-color: #FFFFFF; border-radius: 0 8px 8px 8px; box-shadow: 0 1px 0.5px rgba(0,0,0,0.13); }
        .msg-out { background-color: #E7FFDB; border-radius: 8px 0 8px 8px; box-shadow: 0 1px 0.5px rgba(0,0,0,0.13); }
        .msg-options { background-color: transparent; padding: 0; box-shadow: none; display: flex; flex-direction: column; gap: 8px; align-items: flex-start; width: 85%; }
        .wa-btn {
            background-color: white; color: #008069; padding: 12px 16px; border-radius: 8px; width: 100%;
            text-align: center; box-shadow: 0 1px 2px rgba(0,0,0,0.15); transition: all 0.2s; border: 1px solid #f0f0f0;
            cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .wa-btn:active { background-color: #f0f2f5; transform: scale(0.98); }
        .wa-btn-title { font-weight: 600; font-size: 15px; line-height: 1.2; }
        .wa-btn-subtitle { font-weight: 400; font-size: 11px; color: #667781; margin-top: 4px; line-height: 1.2; }
        .typing-dot { animation: typing 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        @keyframes bounceRight { 0%, 100% { transform: translate(0, -50%); } 50% { transform: translate(6px, -50%); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Prote√ß√£o Visual */
        img { pointer-events: none; -webkit-user-drag: none; }
        
        /* Layout Cards */
        .card-msg-container { width: 100%; max-width: 340px; margin-bottom: 5px; }
        .card-cesta-new { background: #fff; border-radius: 12px; border: 1px solid #e0e0e0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); overflow: hidden; display: flex; flex-direction: column; }
        .card-header-visual { display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fff; padding: 0; border-bottom: 1px solid #f0f0f0; position: relative; }
        .card-title-row { width: 100%; padding: 12px 10px; background: #fdfdfd; text-align: center; border-bottom: 1px solid #f0f0f0; }
        .card-title-row h2 { font-size: 1.3rem; margin: 0; color: #0F2546; font-weight: 800; text-transform: uppercase; letter-spacing: -0.5px; line-height: 1.2; }
        .card-img-container { width: 100%; padding: 15px; display: flex; justify-content: center; }
        .card-img-large { width: 180px; height: 180px; object-fit: cover; border-radius: 8px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.15)); }
        .selo-destaque { position: absolute; top: 45px; right: 10px; background: linear-gradient(135deg, #ffb300, #FFB300); color: #0F2546; padding: 4px 10px; border-radius: 20px; font-weight: 800; font-size: 0.7rem; text-transform: uppercase; z-index: 10; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .product-slider-container { background: #f9fafb; padding: 15px 0; position: relative; }
        .product-slider { display: flex; overflow-x: auto; gap: 10px; padding: 0 15px; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
        .product-slide { flex: 0 0 120px; min-height: 160px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 10px 5px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .product-slide img { width: 85px; height: 85px; object-fit: contain; margin-bottom: 8px; }
        .product-info { display: flex; flex-direction: column; line-height: 1.1; }
        .product-qty { font-size: 0.85rem; font-weight: 800; color: #0d5f46; margin-bottom: 3px; }
        .product-name { font-size: 0.75rem; color: #444; font-weight: 600; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .slider-arrow-indicator { position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: rgba(255, 255, 255, 0.9); border: 2px solid #25D366; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 20; animation: bounceRight 1.2s infinite; pointer-events: none; transition: opacity 0.3s; }
        .card-price-display-only { padding: 10px 15px; background: #fff; border-top: 1px solid #eee; }
        .price-item-row { display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 4px; color: #555; }
        .price-item-row strong { color: #ff5252; }
        .order-widget { background: #fff; border-radius: 12px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #25D366; margin-top: 5px; }
        .order-widget h3 { font-size: 1rem; font-weight: 700; color: #0F2546; margin-bottom: 10px; text-align: center; }
        .radio-arroz-option { display: flex; flex-direction: row; align-items: center; justify-content: space-between; padding: 12px 15px; border: 2px solid #eee; border-radius: 8px; margin-bottom: 8px; cursor: pointer; background: white; transition: all 0.2s; }
        .radio-arroz-option:active { transform: scale(0.98); }
        .radio-arroz-option.selected { border-color: #25D366; background: #f0fff4; }
        .radio-arroz-info { display: flex; flex-direction: row; justify-content: space-between; align-items: center; width: 100%; padding-right: 15px; }
        .radio-arroz-name { font-weight: 600; font-size: 0.9rem; color: #333; }
        .radio-arroz-price { color: #ff5252; font-weight: 800; font-size: 1rem; }
        .btn-encomendar-card { width: 100%; background-color: #25D366; color: white; border: none; padding: 14px; border-radius: 8px; font-size: 1rem; font-weight: 800; text-transform: uppercase; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 10px; box-shadow: 0 3px 0 #189d4b; transition: transform 0.1s; }
        .btn-encomendar-card:active { transform: translateY(3px); box-shadow: none; }
        .company-social-row { display: flex; justify-content: center; gap: 15px; padding: 10px; background: #f9f9f9; border-top: 1px solid #eee; }
        .company-social-btn { color: #555; font-size: 1.5rem; transition: color 0.2s; }
        .company-social-btn:hover { color: #008069; }
    </style>
</head>
<body class="h-[100dvh] flex flex-col overflow-hidden">

    <!-- HEADER -->
    <header class="wa-header text-white p-3 flex items-center shadow-md z-30 shrink-0">
        <div class="w-10 h-10 rounded-full bg-gray-300 overflow-hidden mr-3 border border-white/30 relative shrink-0">
            <img src="img/logo.png" onerror="this.src='https://api.dicebear.com/7.x/avataaars/svg?seed=Osvaldo&backgroundColor=c0aede'" alt="Osvaldo" class="w-full h-full object-cover">
            <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-400 rounded-full border-2 border-white"></div>
        </div>
        <div class="flex-1 min-w-0">
            <h1 class="font-bold text-lg leading-tight truncate">Osvaldo - Cestas</h1>
            <p id="status-text" class="text-xs text-green-100/80 truncate">Online</p>
        </div>
        <div class="flex gap-4 text-xl shrink-0">
            <a href="https://instagram.com" target="_blank" class="text-white hover:text-gray-200 pointer-events-auto"><i class="ph ph-instagram-logo"></i></a>
            <a href="#" class="text-white hover:text-gray-200 pointer-events-auto"><i class="ph ph-globe"></i></a>
            <a href="https://wa.me/5565998150975" target="_blank" class="text-white hover:text-gray-200 pointer-events-auto"><i class="ph ph-whatsapp-logo"></i></a>
        </div>
    </header>

    <!-- CHAT AREA -->
    <main id="chat-container" class="wa-bg flex-1 overflow-y-auto p-4 space-y-3 relative scrolling-touch">
        <!-- Messages area -->
    </main>

    <!-- INPUT AREA -->
    <footer id="input-footer" class="bg-[#F0F2F5] p-2 flex items-center gap-2 shrink-0 z-30 pb-safe">
        <div class="flex-1 bg-white rounded-full px-4 py-2 shadow-sm flex items-center">
            <input type="text" id="user-input" placeholder="Digite seu nome..." class="w-full outline-none text-base bg-transparent text-gray-800" autocomplete="off">
        </div>
        <div id="send-btn" class="bg-[#008069] text-white rounded-full p-3 shadow-md cursor-pointer transition active:scale-95 flex items-center justify-center">
            <i class="ph-fill ph-paper-plane-right text-xl"></i>
        </div>
    </footer>

    <script>
        // === CORE DO SISTEMA (MODO PROTEGIDO) ===
        (function() {
            // DADOS CR√çTICOS (Pre√ßos e Produtos)
            // Congelando objeto para evitar modifica√ß√£o via Console por clonadores
            const _DATA = Object.freeze({
                owner: "Osvaldo",
                groupLink: "https://chat.whatsapp.com/IOI3gSBLRVk4jGK2QMunp1",
                phone: "5565998150975",
                insta: "https://instagram.com/cestas.dona.antonia.cuiaba.vg",
                cestas: [
                    {
                        id: 'grande', nome: 'Cesta Grande', arrozQtd: 4, brindeNome: '1 OMO 800g',
                        brindeImg: 'img/limpezaehigiente/sab√£o em p√≥ omo 800g.webp',
                        img: 'https://donaantonia.com.br/img/cesta-basica-cuiaba-varzea-grande-grande.avif',
                        items: ['4 Arroz Koblenz 5kg', '3 A√ß√∫car Doce Dia 2kg', '4 √ìleo de Soja Liza 900ml', '4 Feij√£o Da Casa 1kg', '1 Caf√© Caboclo 500g', '3 Espaguete QDelicia 500g', '12 Ovos', '1 Bolo Apti Chocolate 400g', '1 Trigo Vitoriosa 1kg', '1 Sal 1kg', '2 Molho Fugini 340g', '1 Milho Verde Predileta', '1 Tempero Tio Jonas', '2 Bolacha MyBit Recheada', '2 Miojo Apti', '4 Suco Frisco', '1 Sab√£o Barra Ype 900g', '2 Creme Dental Sorriso 70g', '2 Papel Higi√™nico', '1 Amaciante Ype 2L', '1 Desinfetante Remmus 2L', '1 Sab√£o em P√≥ OMO 800g', '2 Detergente Ype 500ml', '1 Qboa 1 Litro', '4 Sabonete Palmolive 85g', '1 L√£ de A√ßo Assolan', '1 Esponja de Lavar Lou√ßa'],
                        opcoes: [{ arroz: 'Tio Alvino', preco: '380,00' }, { arroz: 'Koblenz', preco: '390,00' }]
                    },
                    {
                        id: 'media', nome: 'Cesta M√©dia', arrozQtd: 3, brindeNome: '1 Caf√© 250g',
                        brindeImg: 'img/alimento/cafe caboclo 250g.webp',
                        img: 'https://donaantonia.com.br/img/cesta-basica-cuiaba-varzea-grande-media.avif',
                        items: ['3 Arroz Koblenz 5kg', '2 A√ß√∫car Doce Dia 2kg', '3 √ìleo de Soja Liza 900ml', '3 Feij√£o Da Casa 1kg', '1 Caf√© Caboclo 500g', '12 Ovos', '1 Bolo Apti Chocolate 400g', '2 Espaguete QDelicia 500g', '1 Trigo Vitoriosa 1kg', '1 Sal 1kg', '2 Molho Fugini 340g', '1 Milho Verde Predileta', '1 Tempero Tio Jonas', '2 Bolacha MyBit Recheada', '2 Miojo Apti', '3 Suco Frisco', '1 Sab√£o Barra Ype 900g', '2 Creme Dental Sorriso 70g', '2 Papel Higi√™nico', '1 Amaciante Ype 2L', '1 Desinfetante Remmus 2L', '1 Sab√£o em P√≥ OMO 800g', '2 Detergente Ype 500ml', '1 Qboa 1 Litro', '3 Sabonete Palmolive 85g', '1 L√£ de A√ßo Assolan', '1 Esponja de Lavar Lou√ßa'],
                        opcoes: [{ arroz: 'Tio Alvino', preco: '320,00' }, { arroz: 'Koblenz', preco: '325,00' }]
                    },
                    {
                        id: 'pequena', nome: 'Cesta Pequena', arrozQtd: 2, brindeNome: '1 Amaciante 2L',
                        brindeImg: 'img/limpezaehigiente/amaciante ype 2L.webp',
                        img: 'https://donaantonia.com.br/img/cesta-basica-cuiaba-varzea-grande-pequena.avif',
                        items: ['2 Arroz Koblenz 5kg', '1 A√ß√∫car Doce Dia 2kg', '2 √ìleo de Soja Liza 900ml', '2 Feij√£o Da Casa 1kg', '1 Caf√© Caboclo 250g', '12 Ovos', '1 Bolo Apti Chocolate 400g', '1 Espaguete QDelicia 500g', '1 Trigo Vitoriosa 1kg', '1 Sal 1kg', '1 Molho Fugini 340g', '1 Milho Verde Predileta', '1 Tempero Tio Jonas', '2 Bolacha MyBit Recheada', '2 Miojo Apti', '2 Suco Frisco', '1 Sab√£o Barra Ype 900g', '1 Creme Dental Sorriso 70g', '1 Papel Higi√™nico', '1 Amaciante Ype 2L', '1 Desinfetante Remmus 2L', '1 Sab√£o em P√≥ OMO 800g', '2 Detergente Ype 500ml', '1 Qboa 1 Litro', '2 Sabonete Palmolive 85g', '1 L√£ de A√ßo Assolan', '1 Esponja de Lavar Lou√ßa'],
                        opcoes: [{ arroz: 'Tio Alvino', preco: '215,00' }, { arroz: 'Koblenz', preco: '220,00' }]
                    },
                    {
                        id: 'mini', nome: 'Cesta Mini', arrozQtd: 1, brindeNome: '1 Feij√£o 1kg',
                        brindeImg: 'img/alimento/feij√£o da casa.webp',
                        img: 'https://donaantonia.com.br/img/cesta-basica-cuiaba-varzea-grande-mini.avif',
                        items: ['1 Arroz Koblenz 5kg', '1 A√ß√∫car Doce Dia 2kg', '2 √ìleo de Soja Liza 900ml', '2 Feij√£o Da Casa 1kg', '1 Caf√© Caboclo 250g', '1 Espaguete QDelicia 500g', '1 Sal 1kg', '1 Molho Fugini 340g', '1 Milho Verde Predileta', '1 Bolacha MyBit Recheada', '1 Miojo Apti', '2 Suco Frisco', '1 Sab√£o Barra Ype 900g', '1 Creme Dental Sorriso 70g', '1 Papel Higi√™nico', '1 Amaciante Ype 2L', '1 Desinfetante Remmus 2L', '1 Sab√£o em P√≥ OMO 800g', '1 Detergente Ype 500ml', '1 Qboa 1 Litro', '2 Sabonete Palmolive 85g', '1 L√£ de A√ßo Assolan', '1 Esponja de Lavar Lou√ßa'],
                        opcoes: [{ arroz: 'Tio Alvino', preco: '165,00' }, { arroz: 'Koblenz', preco: '170,00' }]
                    },
                    {
                        id: 'economica', nome: 'Cesta Econ√¥mica', destaque: 'Mais Vendida', arrozQtd: 1, brindeNome: '1 Trigo 1kg',
                        brindeImg: 'img/alimento/trigo vitoriosa.webp',
                        img: 'https://donaantonia.com.br/img/cesta-basica-cuiaba-varzea-grande-economica.avif',
                        items: ['1 Arroz Koblenz 5kg', '1 A√ß√∫car Doce Dia 2kg', '1 √ìleo de Soja Liza 900ml', '1 Feij√£o Da Casa 1kg', '1 Caf√© Caboclo 250g', '1 Espaguete QDelicia 500g', '1 Trigo Vitoriosa 1kg', '1 Farinha Mandioca', '1 Sal 1kg', '1 Molho Fugini 340g', '1 Milho Verde Predileta', '1 Bolacha MyBit Recheada', '1 Miojo Apti', '1 Suco Frisco'],
                        opcoes: [{ arroz: 'Valor √önico', preco: '85,00' }]
                    }
                ]
            });

            // UI Elements
            const chatContainer = document.getElementById('chat-container');
            const userInput = document.getElementById('user-input');
            const sendBtn = document.getElementById('send-btn');
            const statusText = document.getElementById('status-text');
            const inputFooter = document.getElementById('input-footer');

            // Internal State
            let _st = { step: 0, usr: '', dispName: '', viewed: [], tmr: null, currId: null, gift: false };

            const getGreeting = () => {
                const h = new Date().getHours();
                return h < 12 ? "Bom dia" : h < 18 ? "Boa tarde" : "Boa noite";
            };

            const getCurrentTime = () => new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            function scrollToBottom() {
                setTimeout(() => {
                    chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
                }, 100);
            }

            function calcTyping(txt) {
                return Math.min(1000 + (txt.length * 30), 4000);
            }

            function addMsg(txt, snd = 'bot', dly = null) {
                return new Promise(res => {
                    const typTime = dly !== null ? dly : calcTyping(txt);
                    const preDly = snd === 'bot' ? 600 : 0;

                    setTimeout(() => {
                        if (snd === 'bot') {
                            statusText.innerText = 'Digitando...';
                            scrollToBottom();

                            const typId = `t-${Date.now()}`;
                            const typHTML = `
                                <div id="${typId}" class="flex justify-start w-full mb-2">
                                    <div class="msg-in p-3 px-4 rounded-lg relative">
                                        <div class="flex gap-1 text-gray-400">
                                            <div class="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div>
                                            <div class="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div>
                                            <div class="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div>
                                        </div>
                                    </div>
                                </div>`;
                            chatContainer.insertAdjacentHTML('beforeend', typHTML);
                            scrollToBottom();

                            setTimeout(() => {
                                const el = document.getElementById(typId);
                                if(el) el.remove();
                                
                                const isCard = txt.includes('card-cesta-new') || txt.includes('order-widget') || txt.includes('product-slider-container') || txt.includes('final-thank-you');
                                const bubCls = isCard ? 'p-1 bg-transparent shadow-none' : 'p-2 px-3 bg-white shadow-sm';
                                
                                const html = `
                                    <div class="flex justify-start w-full mb-2 fade-in">
                                        <div class="msg-in ${bubCls} rounded-lg relative max-w-[95%] text-gray-800 text-[15px] leading-snug protected-msg">
                                            ${txt}
                                            ${!isCard ? `<span class="block text-[10px] text-gray-400 text-right mt-1 -mr-1">${getCurrentTime()}</span>` : ''}
                                        </div>
                                    </div>`;
                                chatContainer.insertAdjacentHTML('beforeend', html);
                                statusText.innerText = 'Online';
                                scrollToBottom();
                                res();
                            }, typTime);
                        } else {
                            const html = `
                                <div class="flex justify-end w-full mb-2">
                                    <div class="msg-out p-2 px-3 rounded-lg relative max-w-[85%] text-gray-800 text-[15px] leading-snug shadow-sm protected-msg">
                                        ${txt}
                                        <span class="block text-[10px] text-[#97a892] text-right mt-1 -mr-1">
                                            ${getCurrentTime()} <i class="ph-bold ph-checks text-blue-500 ml-1"></i>
                                        </span>
                                    </div>
                                </div>`;
                            chatContainer.insertAdjacentHTML('beforeend', html);
                            scrollToBottom();
                            res();
                        }
                    }, preDly);
                });
            }

            function showOpts(opts) {
                setTimeout(() => {
                    const oid = `o-${Date.now()}`;
                    let btns = opts.map(o => `
                        <button onclick="window._hOpt('${o.text}', '${o.value}', ${o.nextStep}, '${oid}')" 
                                class="wa-btn text-left">
                            <span class="wa-btn-title">${o.text}</span>
                            ${o.subtext ? `<span class="wa-btn-subtitle">${o.subtext}</span>` : ''}
                        </button>
                    `).join('');

                    const html = `
                        <div id="${oid}" class="flex justify-start w-full mb-2">
                            <div class="msg-options">
                                ${btns}
                            </div>
                        </div>`;
                    chatContainer.insertAdjacentHTML('beforeend', html);
                    scrollToBottom();
                }, 800);
            }

            // --- FUN√á√ïES GLOBAIS SEGURAS ---
            window._selRice = function(id, nm, pr) {
                const btn = document.getElementById(`btn-pedir-${id}`);
                const all = document.querySelectorAll(`#widget-${id} .radio-arroz-option`);
                all.forEach(el => el.classList.remove('selected'));
                event.currentTarget.classList.add('selected');

                // TRACKING ADDTOCART
                if(typeof fbq === 'function') {
                    fbq('track', 'AddToCart', {
                        content_name: `Cesta ${id.toUpperCase()} - ${nm}`,
                        value: parseFloat(pr.replace(',', '.')),
                        currency: 'BRL'
                    });
                }

                btn.innerHTML = `<i class="fa-brands fa-whatsapp"></i> Pedir Agora`;
                btn.onclick = () => {
                    if(typeof fbq === 'function') fbq('track', 'InitiateCheckout');
                    const msg = `Ol√°! Aqui √© o ${_st.dispName}. Quero encomendar a *Cesta ${id.toUpperCase()}* com *Arroz ${nm}* por *R$ ${pr}*.`;
                    window.open(`https://wa.me/${_DATA.phone}?text=${encodeURIComponent(msg)}`, '_blank');
                    _hPostClick();
                }
            };

            window._slScroll = function(el) {
                const arr = el.parentElement.querySelector('.slider-arrow-indicator');
                if (el.scrollLeft > 20) { if(arr) arr.style.opacity = '0'; } else { if(arr) arr.style.opacity = '1'; }
                
                if (_st.cInt) return; 
                if (el.scrollLeft + el.clientWidth >= el.scrollWidth - 30) {
                    _trigPostFlow();
                }
            };

            function _hPostClick() {
                setTimeout(() => {
                    _st.step = 100;
                    _flow();
                }, 1500);
            }

            function _trigPostFlow() {
                if (_st.cInt) return;
                _st.cInt = true;
                clearTimeout(_st.cTm);
                _shPostMsgs();
            }

            async function _shPostMsgs() {
                const c = _DATA.cestas.find(x => x.id === _st.currId);
                const nm = c ? c.nome : 'esta cesta';

                await addMsg(`O que quer fazer agora?`, 'bot');
                showOpts([
                    { text: `Encomendar a ${nm} ‚úÖ`, value: "encomendar_atual", nextStep: 6 },
                    { text: "Ver outras cestas üîÑ", value: "ver_outra", nextStep: 4 },
                    { text: "Quem somos n√≥s? üè¢", value: "quem_somos", nextStep: 7 },
                    { text: "Ver formas de pagamento üí≥", value: "pagamento", nextStep: 6 }
                ]);
            }

            function _getImg(txt) {
                const l = txt.toLowerCase();
                let n = 'outros.png';
                let f = 'img/alimento/';

                if(l.includes('arroz')) n = 'Arroz Koblenz 5kg.webp';
                else if(l.includes('a√ß√∫car') || l.includes('acucar')) n = 'a√ßucar doce dia 2 kg.webp';
                else if(l.includes('bolacha')) n = 'bolacha mybit.webp';
                else if(l.includes('bolo') || l.includes('mistura')) n = 'bolo apti chocolate.webp';
                else if(l.includes('caf√©') || l.includes('cafe') || l.includes('caboclo')) {
                    if(l.includes('500g')) n = 'cafe caboclo 500g.webp';
                    else n = 'cafe caboclo 250g.webp';
                }
                else if(l.includes('espaguete')) n = 'espaguete qdelicia.webp';
                else if(l.includes('esponja de a√ßo') || l.includes('l√£ de a√ßo') || l.includes('assolan')) {
                    n = 'l√£ de a√ßo assolan.webp'; f = 'img/limpezaehigiente/';
                }
                else if(l.includes('esponja')) { n = 'esponja de lavar lou√ßa.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('feij√£o') || l.includes('feijao')) n = 'feij√£o da casa.webp';
                else if(l.includes('milho')) n = 'milho verde predileta.webp';
                else if(l.includes('miojo')) n = 'miojo apti.webp';
                else if(l.includes('molho')) n = 'molho fugini.webp';
                else if(l.includes('oleo') || l.includes('√≥leo')) n = 'oleo de soja liza.webp';
                else if(l.includes('ovo')) n = 'ovo duzia.jpg';
                else if(l.includes('sal')) n = 'sal.webp';
                else if(l.includes('suco')) n = 'suco frisco.webp';
                else if(l.includes('tempero')) n = 'tempero tio jonas.jpg';
                else if(l.includes('trigo')) n = 'trigo vitoriosa.webp';
                else if(l.includes('creme dental')) { n = 'Creme Dental Sorriso 70g.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('desinfetante')) { n = 'Desinfetante Remmus 2L.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('detergente')) { n = 'Detergente Ype 500ml.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('qboa')) { n = 'Qboa 1 Litro.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('amaciante')) { n = 'amaciante ype 2L.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('sabonete')) { n = 'sabonete palmolive 85g.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('sab√£o barra') || l.includes('sabao barra')) { n = 'sab√£o barra ype 900g.webp'; f = 'img/limpezaehigiente/'; }
                else if(l.includes('sab√£o p√≥') || l.includes('sab√£o em p√≥') || l.includes('omo')) { n = 'sab√£o em p√≥ omo 800g.webp'; f = 'img/limpezaehigiente/'; }

                return `${f}${n}`;
            }

            function _prsItm(txt) {
                const m = txt.match(/^(\d+)\s+(.*)$/);
                if(m) {
                    const q = parseInt(m[1]);
                    return { qty: q > 1 ? `${q} unidades` : `${q} unidade`, name: m[2], img: _getImg(m[2] + (txt.includes('500g') ? ' 500g' : '')) }; 
                }
                return { qty: '1 unidade', name: txt, img: _getImg(txt) };
            }

            function _genCard(c) {
                const slds = c.items.map(i => {
                    const p = _prsItm(i);
                    const fb = `https://placehold.co/80x80/eee/999?text=${p.name.substring(0,3).toUpperCase()}`;
                    return `
                    <div class="product-slide">
                        <img src="${p.img}" onerror="this.src='${fb}'" alt="${p.name}">
                        <div class="product-info">
                            <span class="product-qty">${p.qty}</span>
                            <span class="product-name">${p.name}</span>
                        </div>
                    </div>`;
                }).join('');
                
                const prcs = c.opcoes.map(o => `
                    <div class="price-item-row">
                        <span>${o.arroz.includes('Valor') ? 'Valor √önico' : 'Com ' + o.arroz}</span>
                        <strong>R$ ${o.preco}</strong>
                    </div>
                `).join('');

                return `
                <div class="card-msg-container">
                    <div class="card-cesta-new">
                        <div class="card-header-visual">
                            <div class="card-title-row">
                                <h2>${c.nome}</h2>
                            </div>
                            ${c.destaque ? `<div class="selo-destaque">${c.destaque}</div>` : ''}
                            <div class="card-img-container">
                                <img src="${c.img}" class="card-img-large" alt="${c.nome}">
                            </div>
                        </div>
                        <div class="product-slider-container">
                            <div class="slider-wrapper">
                                <div class="product-slider" onscroll="window._slScroll(this)">
                                    ${slds}
                                    <div style="min-width: 15px;"></div>
                                </div>
                                <div class="slider-arrow-indicator">
                                    <i class="ph-bold ph-caret-right text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="card-price-display-only">${prcs}</div>
                    </div>
                </div>`;
            }

            function _genComp() {
                const ft = ['fachada.jpg', 'equipe.jpg', 'estoque.jpg']; 
                const slds = ft.map((f, i) => {
                    const fb = `https://placehold.co/400x250/eee/999?text=Dona+Antonia+${i+1}`;
                    return `
                    <div class="product-slide" style="flex: 0 0 240px; border:none; box-shadow:none; min-height:auto;">
                        <img src="img/empresa/${f}" onerror="this.src='${fb}'" style="width:100%; height:160px; object-fit:cover; border-radius:8px;" alt="Empresa">
                    </div>`;
                }).join('');

                return `
                <div class="card-msg-container">
                    <div class="card-cesta-new">
                        <div class="card-header-visual" style="flex-direction:row;">
                            <img src="img/logo.png" style="width:70px; height:70px; border-radius:50%;" onerror="this.src='https://api.dicebear.com/7.x/avataaars/svg?seed=Osvaldo'">
                            <div class="card-title-right">
                                <h2 style="font-size:1.1rem">Dona Ant√¥nia Alimentos</h2>
                                <p style="font-size:0.8rem; color:#666;">Desde 2016 em Cuiab√° & VG</p>
                            </div>
                        </div>
                        <div class="product-slider-container" style="padding: 10px 0;">
                            <div class="slider-wrapper">
                                <div class="product-slider">
                                    ${slds}
                                    <div style="min-width: 15px;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="company-social-row">
                            <a href="${_DATA.insta}" target="_blank" class="company-social-btn"><i class="ph ph-instagram-logo text-pink-600"></i></a>
                            <a href="#" class="company-social-btn"><i class="ph ph-facebook-logo text-blue-600"></i></a>
                            <a href="https://wa.me/${_DATA.phone}" target="_blank" class="company-social-btn"><i class="ph ph-whatsapp-logo text-green-500"></i></a>
                        </div>
                    </div>
                </div>`;
            }

            function _genGift() {
                const gfts = _DATA.cestas.map(c => ({ c: c.nome, n: c.brindeNome, i: c.brindeImg }));
                const slds = gfts.map(g => {
                    const fb = `https://placehold.co/120x120/eee/999?text=${g.n.split(' ')[1]}`;
                    return `
                    <div class="product-slide" style="flex: 0 0 140px; border-color: #fcd34d;">
                        <img src="${g.i}" onerror="this.src='${fb}'" style="width:70px; height:70px; margin-bottom:5px;">
                        <div class="product-info">
                            <span style="font-size:0.7rem; color:#666; margin-bottom:2px;">${g.c}</span>
                            <span style="font-size:0.85rem; font-weight:800; color:#008069; line-height:1.1;">${g.n}</span>
                        </div>
                    </div>`;
                }).join('');

                return `
                <div class="card-msg-container" style="margin-top:5px;">
                    <div class="card-cesta-new" style="border: 2px solid #fcd34d;">
                        <div style="background:#fffbeb; padding:10px; text-align:center; border-bottom:1px solid #fcd34d;">
                            <h3 style="font-size:0.95rem; font-weight:800; color:#b45309; margin:0;"><i class="ph-fill ph-gift"></i> BRINDES NA 1¬™ COMPRA</h3>
                        </div>
                        <div class="product-slider-container" style="background:#fff; padding:15px 0;">
                            <div class="slider-wrapper">
                                <div class="product-slider">
                                    ${slds}
                                    <div style="min-width: 15px;"></div>
                                </div>
                                <div class="slider-arrow-indicator">
                                    <i class="ph-bold ph-caret-right text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            }

            function _genWid(c) {
                const opts = c.opcoes.map(o => `
                    <div class="radio-arroz-option" onclick="window._selRice('${c.id}', '${o.arroz}', '${o.preco}')">
                        <div class="radio-arroz-info">
                            <span class="radio-arroz-name">${o.arroz.includes('Valor') ? 'Valor √önico' : 'Com ' + o.arroz}</span>
                            <span class="radio-arroz-price">R$ ${o.preco}</span>
                        </div>
                        <div class="w-5 h-5 rounded-full border-2 border-gray-300 flex items-center justify-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full hidden selection-dot"></div>
                        </div>
                    </div>
                `).join('');

                return `
                <div class="card-msg-container">
                    <div id="widget-${c.id}" class="order-widget">
                        <h3>Finalize seu pedido da ${c.nome}:</h3>
                        <p style="margin-bottom: 10px; font-size: 0.85rem; color:#666; text-align: center;">Escolha o arroz abaixo:</p>
                        ${opts}
                        <button id="btn-pedir-${c.id}" class="btn-encomendar-card">
                            <i class="fa-brands fa-whatsapp"></i> Escolha o Arroz
                        </button>
                    </div>
                </div>`;
            }

            // FLOW LOGIC
            window.onload = async () => {
                setTimeout(async () => {
                    await addMsg(`${getGreeting()}! Tudo bem? üëã`, 'bot', 1000);
                    await addMsg(`Aqui √© o <b>${_DATA.owner}</b>, da Cesta B√°sica Econ√¥mica.`, 'bot', 1500);
                    await addMsg(`Qual √© o seu primeiro nome?`, 'bot', 1200);
                    userInput.focus();
                }, 500);
            };

            async function _hInp() {
                const txt = userInput.value.trim();
                if (!txt) return;

                if (_st.step === 0) {
                    const prts = txt.split(/\s+/);
                    _st.usr = prts[0]; 
                    _st.dispName = prts.slice(0, 2).join(' ');

                    _st.step = 1;
                    userInput.value = '';
                    await addMsg(txt, 'user');
                    inputFooter.style.display = 'none';
                    
                    _flow();
                }
            }

            window._hOpt = async function(txt, val, nStp, cId) {
                const c = document.getElementById(cId);
                if(c) c.remove();

                await addMsg(txt, 'user');
                _st.step = nStp;

                if (_st.step === 5 && val.startsWith('select_cesta_')) {
                    _st.sIdx = parseInt(val.split('_')[2]);
                }

                if (val === 'menu_cestas' || val === 'ver_outra') {
                    _st.step = 4; 
                    _flow('loop_cestas'); 
                    return; 
                }

                if (val === 'salvar_brinde') {
                    if(typeof fbq === 'function') fbq('track', 'Lead'); // Lead tracking
                    window.open(`https://wa.me/${_DATA.phone}?text=Ol√°! Aqui √© o ${_st.dispName}. Salvei seu contato e quero garantir meu brinde!`, '_blank');
                    _hPostClick();
                }

                _flow(val);
            }

            async function _flow(trig) {
                const nm = _st.usr;
                if(_st.tmr) clearTimeout(_st.tmr);

                switch (_st.step) {
                    case 1: 
                        await addMsg(`Prazer, ${nm}! üòÄ`);
                        await addMsg(`Voc√™ j√° conhece a Dona Ant√¥nia Alimentos?`);
                        showOpts([
                            { text: "Sim, j√° conhe√ßo üëç", value: "sim", nextStep: 3 },
                            { text: "N√£o conhe√ßo ü§î", value: "nao", nextStep: 2 }
                        ]);
                        break;

                    case 2: 
                        await addMsg(_genComp());
                        await addMsg(`Somos de Cuiab√°, com 8 anos de tradi√ß√£o entregando qualidade na sua mesa.`);
                        setTimeout(() => { _st.step = 3; _flow(); }, 4000);
                        break;

                    case 3: 
                        await addMsg(`Vou te mostrar as nossas cestas pra voc√™ conhecer.`);
                        showOpts([{ text: "OK, mostrar cestas", value: "ok", nextStep: 4 }]);
                        break;

                    case 4: 
                        if (trig === 'loop_cestas') await addMsg(`D√° uma olhada nas outras op√ß√µes üëá`);
                        
                        let opc = [];
                        _DATA.cestas.forEach((c, i) => {
                            if (!_st.viewed.includes(c.id)) {
                                opc.push({
                                    text: c.nome,
                                    subtext: `(${c.arrozQtd} pacote${c.arrozQtd > 1 ? 's' : ''} de arroz)`,
                                    value: `select_cesta_${i}`,
                                    nextStep: 5 
                                });
                            }
                        });

                        if (opc.length === 0) {
                            _st.viewed = []; 
                            _DATA.cestas.forEach((c, i) => {
                                opc.push({
                                    text: c.nome,
                                    subtext: `(${c.arrozQtd} pacote${c.arrozQtd > 1 ? 's' : ''} de arroz)`,
                                    value: `select_cesta_${i}`,
                                    nextStep: 5
                                });
                            });
                        }

                        opc.push({ text: "Formas de Pagamento üí≥", subtext: "Ver como pagar e brindes", value: "pagamento", nextStep: 6 });
                        showOpts(opc);
                        break;

                    case 5: 
                        const idx = _st.sIdx !== null ? _st.sIdx : 0; 
                        const c = _DATA.cestas[idx];
                        
                        _st.currId = c.id;
                        if(!_st.viewed.includes(c.id)) _st.viewed.push(c.id);

                        // Track ViewContent
                        if(typeof fbq === 'function') {
                            fbq('track', 'ViewContent', { content_name: c.nome, content_ids: [c.id], content_type: 'product' });
                        }

                        await addMsg(`Essa √© a <b>${c.nome}</b>:`);
                        await addMsg(_genCard(c));
                        await addMsg(_genWid(c));

                        _st.tmr = setTimeout(() => {
                            _st.step = 4;
                            _flow('loop_cestas');
                        }, 25000); 
                        break;

                    case 6: 
                        if (_st.gift) {
                            if (trig === 'encomendar_atual') { _st.step = 3; _flow(); return; }
                            if (trig === 'pagamento') { _st.step = 6; }
                        }
                        _st.gift = true;

                        await addMsg(`Facilitamos o pagamento pra voc√™:`);
                        const pay = `
                            <ul class="list-disc pl-5 space-y-1">
                                <li><b>Cart√£o de Cr√©dito</b> em at√© 3x</li>
                                <li><b>Cart√£o de D√©bito</b></li>
                                <li><b>PIX</b> ou <b>Dinheiro</b> na entrega</li>
                                <li><b>Vale Alimenta√ß√£o/Refei√ß√£o:</b> Alelo, Sodexo, Pluxee, Caju, Flash, iFood...</li>
                                <li class="text-red-500 font-bold">N√£o vendemos pra 30 dias</li>
                            </ul>`;
                        await addMsg(pay);
                        
                        const alert = `<div style="background-color:#fef9c3; color:#854d0e; padding:10px; border-radius:8px; text-align:center; font-weight:600; border:1px solid #fde047;">Aqui voc√™ s√≥ paga quando recebe a cesta na sua casa.</div>`;
                        await addMsg(alert);

                        setTimeout(async () => {
                            await addMsg(`üéÅ ${nm}, eu vou garantir um brinde pra quando voc√™ fizer a sua primeira compra.`);
                            await addMsg(_genGift());

                            showOpts([
                                { text: "Salvar contato e garantir brinde üéÅ", subtext: "Clique para confirmar no WhatsApp", value: "salvar_brinde", nextStep: 6 }, 
                                { text: "Ver as Cestas üõí", subtext: "Escolher outra op√ß√£o", value: "menu_cestas", nextStep: 4 },
                                { text: "Entrar no Grupo VIP üöÄ", subtext: "Ofertas rel√¢mpago", value: "vip", nextStep: 99 }
                            ]);
                        }, 2000);
                        break;

                    case 7: 
                        await addMsg(`Que bom que voc√™ quer saber mais sobre a gente! ü§ù`);
                        await addMsg(_genComp());
                        await addMsg(`Somos de Cuiab√°, com 8 anos de tradi√ß√£o entregando qualidade na sua mesa.`);
                        await addMsg(`E a√≠, vamos aproveitar?`, 'bot', 2000);
                        showOpts([
                            { text: "Ganhar meu Brinde üéÅ", value: "salvar_brinde", nextStep: 6 },
                            { text: "Ver as Cestas novamente üõí", value: "menu_cestas", nextStep: 4 }
                        ]);
                        break;
                        
                    case 99: 
                        if(trig === 'salvar') {
                            window.open(`https://wa.me/${_DATA.phone}?text=Ol√°! Aqui √© o ${_st.dispName}. Salvei o contato!`, '_blank');
                            _hPostClick();
                        }
                        if(trig === 'vip') {
                            if(typeof fbq === 'function') fbq('trackCustom', 'JoinGroup');
                            window.open(_DATA.groupLink, '_blank');
                            _hPostClick();
                        }
                        break;

                    case 100: 
                        await addMsg(`Obrigado, ${nm}! Estamos prontos para te atender no WhatsApp. üü¢`);
                        await addMsg(`Enquanto isso, siga a gente no Instagram para acompanhar as novidades:`);
                        
                        const ib = `
                            <div class="flex justify-center w-full mt-2 mb-4">
                                <a href="${_DATA.insta}" target="_blank" 
                                class="bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-3 px-6 rounded-full shadow-lg flex items-center gap-2 hover:opacity-90 transition transform hover:scale-105 no-underline">
                                    <i class="ph-bold ph-instagram-logo text-2xl"></i>
                                    Seguir no Instagram
                                </a>
                            </div>`;
                        
                        chatContainer.insertAdjacentHTML('beforeend', ib);
                        scrollToBottom();
                        break;
                }
            }

            sendBtn.addEventListener('click', _hInp);
            userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') _hInp(); });

        })(); // FIM DA PROTE√á√ÉO IIFE
    </script>
</body>
</html>
