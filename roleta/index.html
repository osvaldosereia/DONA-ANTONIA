<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Cestas - Roleta da Sorte</title>
    <!-- Importar biblioteca de confetis -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Importar 칤cones -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- CSS: Estilos e Anima칞칫es --- */
        :root {
            --cor-fundo: #f0f2f5;
            --cor-texto: #333;
            --cor-primaria: #ff4757;
            /* Cores das 6 fatias */
            --fatia1: #ff4757; /* Vermelho */
            --fatia2: #ffa502; /* Laranja */
            --fatia3: #2ed573; /* Verde */
            --fatia4: #1e90ff; /* Azul */
            --fatia5: #8e44ad; /* Roxo */
            --fatia6: #f1c40f; /* Amarelo */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle, #ffffff 0%, #f0f2f5 100%);
            color: var(--cor-texto);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            text-align: center;
        }

        /* 츼rea do Log칩tipo */
        .logo-container {
            margin-bottom: 10px;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-container img {
            width: 100%;
            height: auto;
            object-fit: cover;
        }

        .logo-placeholder {
            font-size: 60px;
            color: var(--cor-primaria);
        }

        h1 {
            color: var(--cor-primaria);
            margin: 10px 0;
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        p.subtitle {
            color: #666;
            margin-bottom: 20px;
        }

        /* Container do Formul치rio */
        #form-container {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 350px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            position: relative;
            z-index: 20;
        }

        .input-group {
            text-align: left;
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 0.9rem;
            color: #555;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }

        input:focus {
            border-color: var(--cor-primaria);
            outline: none;
        }

        /* Bot칚o de Girar */
        .btn-girar {
            background: linear-gradient(135deg, #ff4757, #ffa502);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4);
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-girar:active { transform: scale(0.98); }
        .btn-girar:disabled { background: #ccc; cursor: not-allowed; box-shadow: none; }

        /* --- Estrutura da Roleta (6 Fatias) --- */
        .wheel-wrapper {
            position: relative;
            margin: 0 auto 20px auto;
            width: 320px;
            height: 320px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background-color: #333;
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            z-index: 10;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 10px solid white;
            box-shadow: 0 0 20px rgba(0,0,0,0.15);
            box-sizing: border-box;
            background: conic-gradient(
                var(--fatia1) 0deg 60deg,
                var(--fatia2) 60deg 120deg,
                var(--fatia3) 120deg 180deg,
                var(--fatia4) 180deg 240deg,
                var(--fatia5) 240deg 300deg,
                var(--fatia6) 300deg 360deg
            );
            transition: transform 5s cubic-bezier(0.25, 0.1, 0.25, 1);
            position: relative;
            overflow: hidden; 
        }

        .wheel::after {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 25px;
            height: 25px;
            background: white;
            border-radius: 50%;
            z-index: 5;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        /* --- NOVA L칍GICA DE ALINHAMENTO DO TEXTO --- */
        /* Container invis칤vel que roda a partir do centro */
        .label-container {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            /* N칚o tem tamanho, serve apenas de 칙ncora de rota칞칚o */
        }

        /* O texto em si */
        .wheel-label {
            position: absolute;
            /* Empurra para cima (raio negativo) para chegar  borda */
            top: -125px; 
            left: 0;
            transform: translateX(-50%); /* Centraliza horizontalmente na 칙ncora */
            
            width: 120px; /* Largura segura para n칚o quebrar linha f치cil */
            text-align: center;
            
            font-size: 18px;
            font-weight: 800;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            white-space: nowrap; /* Tenta manter numa linha s칩 */
            z-index: 2;
        }

        /* Modal de Resultado */
        #result-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .result-content {
            background: white;
            padding: 40px 20px;
            border-radius: 25px;
            text-align: center;
            width: 100%;
            max-width: 350px;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 30px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            line-height: 1;
        }
        .close-btn:hover { color: #333; }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .prize-icon {
            font-size: 50px;
            margin-bottom: 10px;
        }

        .prize-value {
            font-size: 32px;
            color: var(--cor-primaria);
            font-weight: 800;
            margin: 15px 0 25px 0;
            line-height: 1.2;
        }

        .btn-whatsapp {
            background-color: #25D366;
            color: white;
            text-decoration: none;
            padding: 15px 15px;
            border-radius: 50px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
            transition: transform 0.2s;
            font-size: 1rem;
            text-transform: uppercase;
        }

        .btn-whatsapp:hover { transform: translateY(-2px); }

        .hidden { display: none !important; }
        
        #message-area {
            margin-top: 20px;
            font-weight: bold;
            color: #d63031;
            padding: 15px;
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            border: 2px solid #d63031;
            display: none;
            width: 90%;
            max-width: 320px;
        }

        .debug-btn {
            margin-top: 50px;
            background: none;
            border: 1px solid #ccc;
            padding: 5px 10px;
            font-size: 12px;
            color: #999;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="logo-container">
        <img src="Gemini_Generated_Image_9k3xib9k3xib9k3x (1).png" alt="Logo Super Cestas" onerror="this.style.display='none'; document.querySelector('.logo-placeholder').style.display='block';">
        <div class="logo-placeholder" style="display:none;"><i class="fas fa-gift"></i></div>
    </div>

    <h1>Super Cestas</h1>
    <p class="subtitle">Rode a roleta e ganhe descontos!</p>

    <!-- Formul치rio -->
    <div id="form-container">
        <div class="input-group">
            <label for="nomeInput">Seu Nome</label>
            <input type="text" id="nomeInput" placeholder="Ex: Maria">
        </div>
        <div class="input-group">
            <label for="whatsappInput">Seu WhatsApp</label>
            <input type="tel" id="whatsappInput" placeholder="Ex: 998150975">
        </div>
        <button class="btn-girar" id="spinBtn">GIRAR AGORA</button>
    </div>

    <!-- Roleta -->
    <div class="wheel-wrapper" id="wheelArea">
        <div class="pointer"></div>
        <div class="wheel" id="wheel">
            <!-- Textos gerados via JS -->
        </div>
    </div>

    <div id="message-area"></div>

    <!-- Modal de Resultado -->
    <div id="result-modal">
        <div class="result-content">
            <button class="close-btn" id="closeModalBtn">&times;</button>
            <div class="prize-icon">游꿀</div>
            <h2>PARAB칄NS!</h2>
            <p>Voc칡 ganhou um desconto de:</p>
            <div class="prize-value" id="prizeDisplay">--</div>
            
            <a href="#" id="whatsappLink" class="btn-whatsapp" target="_blank">
                <i class="fab fa-whatsapp" style="font-size: 1.4rem;"></i>
                游녤 PEGAR MEU PR칄MIO NO ZAP
            </a>
            <p style="font-size: 0.8rem; color: #999; margin-top: 15px;">Tire um print se preferir!</p>
        </div>
    </div>

    <button class="debug-btn" onclick="resetTest()">游댃 Reset (Bot칚o de Teste)</button>

    <script>
        // --- 6 PR칄MIOS ---
        const premios = [
            "R$ 5,00",   // Fatia 1 (Vermelho)
            "R$ 6,00",   // Fatia 2 (Laranja)
            "R$ 7,00",   // Fatia 3 (Verde)
            "R$ 8,00",   // Fatia 4 (Azul)
            "R$ 9,00",   // Fatia 5 (Roxo)
            "R$ 10,00"   // Fatia 6 (Amarelo)
        ];

        // Elementos
        const wheel = document.getElementById('wheel');
        const spinBtn = document.getElementById('spinBtn');
        const formContainer = document.getElementById('form-container');
        const messageArea = document.getElementById('message-area');
        const resultModal = document.getElementById('result-modal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const prizeDisplay = document.getElementById('prizeDisplay');
        const whatsappLink = document.getElementById('whatsappLink');
        const nomeInput = document.getElementById('nomeInput');
        const whatsappInput = document.getElementById('whatsappInput');

        let isSpinning = false;
        let currentRotation = 0;

        // --- ALINHAMENTO PERFEITO DOS TEXTOS ---
        function drawWheelLabels() {
            const numberOfSlices = premios.length;
            const sliceAngle = 360 / numberOfSlices;
            
            premios.forEach((premio, index) => {
                // 1. Criar um container 칙ncora no centro (0x0px)
                const container = document.createElement('div');
                container.className = 'label-container';
                
                // 2. Rodar a 칙ncora para apontar para o centro da fatia
                // Posi칞칚o inicial (0) + (index * 칙ngulo) + (metade do 칙ngulo)
                const rotation = (index * sliceAngle) + (sliceAngle / 2);
                container.style.transform = `rotate(${rotation}deg)`;
                
                // 3. Criar o texto
                const label = document.createElement('div');
                label.className = 'wheel-label';
                label.textContent = premio;
                
                // 4. Montar
                container.appendChild(label);
                wheel.appendChild(container);
            });
        }
        
        drawWheelLabels();

        // --- VERIFICA칂츾O DI츼RIA ---
        function checkDailyLimit() {
            const hoje = new Date().toLocaleDateString();
            const lastSpin = localStorage.getItem('superCestas_lastSpin');
            if (lastSpin === hoje) {
                lockGame();
                return false;
            }
            return true;
        }

        function lockGame() {
            formContainer.classList.add('hidden');
            messageArea.innerHTML = `
                <i class="fas fa-calendar-check" style="font-size: 30px; display: block; margin-bottom: 10px;"></i>
                Voc칡 j치 girou hoje!<br><br>
                Volte amanh칚 para tentar a sorte de novo.
            `;
            messageArea.style.display = 'block';
        }

        closeModalBtn.addEventListener('click', () => {
            resultModal.style.display = 'none';
            lockGame();
        });

        // --- L칍GICA DO GIRO ---
        spinBtn.addEventListener('click', () => {
            const nome = nomeInput.value.trim();
            const wa = whatsappInput.value.trim();

            if (!nome || !wa) {
                alert("Opa! Coloque seu nome e WhatsApp antes de girar.");
                return;
            }

            if (isSpinning) return;
            if (!checkDailyLimit()) return;

            isSpinning = true;
            messageArea.style.display = 'none';
            formContainer.classList.add('hidden'); 

            // C치lculo da Rota칞칚o
            const extraSpins = 5 * 360; 
            const randomDegree = Math.floor(Math.random() * 360);
            
            // Queremos que a roda pare no meio de uma fatia para ficar bonito
            // SliceSize = 60. Centro = 30.
            const sliceSize = 360 / premios.length;
            
            // A l칩gica de "randomDegree" pura pode parar na linha. Vamos for칞ar o centro.
            // Escolhemos um 칤ndice aleat칩rio de pr칠mio (0 a 5)
            const winningIndexTarget = Math.floor(Math.random() * premios.length);
            
            // Calculamos o 칙ngulo necess치rio para esse 칤ndice parar no topo (ponteiro)
            // Ponteiro est치 em 0.
            // Para o 칤ndice X estar no topo, a roda tem de rodar: 
            // (360 - (X * sliceSize + sliceSize/2))
            const targetAngleForIndex = (360 - (winningIndexTarget * sliceSize) - (sliceSize / 2));
            
            // Adicionamos as voltas extras
            const totalRotation = currentRotation + extraSpins + targetAngleForIndex;
            
            // Pequena varia칞칚o aleat칩ria de +/- 10 graus para n칚o parecer rob칩tico, mas sem sair da fatia
            const fuzz = Math.floor(Math.random() * 20) - 10; 
            const finalRotation = totalRotation + fuzz;

            wheel.style.transform = `rotate(${finalRotation}deg)`;

            setTimeout(() => {
                isSpinning = false;
                currentRotation = finalRotation;
                calculateWinner(finalRotation);
            }, 5000);
        });

        function calculateWinner(rotation) {
            const actualDeg = rotation % 360;
            const sliceSize = 360 / premios.length;
            
            // F칩rmula precisa para detectar o 칤ndice baseado no 칙ngulo final
            // Ex: Se rodou 30 graus, o 칤ndice 0 (que estava em 30) passou. O 칤ndice 5 desceu.
            // Corre칞칚o matem치tica para alinhar com o ponteiro no topo
            let winningIndex = Math.floor((360 - actualDeg + (sliceSize/2)) % 360 / sliceSize);
            
            // Garantia de limites (caso bugue para -1 ou 6)
            if (winningIndex < 0) winningIndex = 0;
            if (winningIndex >= premios.length) winningIndex = 0;

            const premioGanho = premios[winningIndex];
            
            const hoje = new Date().toLocaleDateString();
            localStorage.setItem('superCestas_lastSpin', hoje);

            showResult(premioGanho);
        }

        function showResult(premio) {
            fireConfetti();
            prizeDisplay.innerText = premio + " OFF";
            
            const nome = nomeInput.value;
            const wa = whatsappInput.value;
            const empresaWA = "998150975";
            
            const texto = `Opa! Sou ${nome} (${wa}). Ganhei desconto de *${premio}* na roleta. Quero usar!`;
            
            whatsappLink.href = `https://wa.me/${empresaWA}?text=${encodeURIComponent(texto)}`;

            setTimeout(() => {
                resultModal.style.display = 'flex';
            }, 500);
        }

        function fireConfetti() {
            var count = 200;
            var defaults = { origin: { y: 0.7 } };
            function fire(particleRatio, opts) {
                confetti(Object.assign({}, defaults, opts, {
                    particleCount: Math.floor(count * particleRatio)
                }));
            }
            fire(0.25, { spread: 26, startVelocity: 55 });
            fire(0.2, { spread: 60 });
            fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
            fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
            fire(0.1, { spread: 120, startVelocity: 45 });
        }

        function resetTest() {
            localStorage.removeItem('superCestas_lastSpin');
            location.reload();
        }

        checkDailyLimit();

    </script>
</body>
</html>
